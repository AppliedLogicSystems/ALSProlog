<h2 id="forms">FORMS</h2>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'$c_malloc'(Size, Ptr)

'$c_free'(Ptr)

'$c_set'(Ptr_or_UIA, FormatList)

'$c_examine'(Ptr_or_UIA, FormatList)
</code></pre></div></div>
<h2 id="description">DESCRIPTION</h2>

<p>The following predicates are low-level C-defined builtins in ALS Prolog, providing access to C data areas, as well as UIAs treated as such data areas.</p>

<p><strong><code class="highlighter-rouge">'$c_malloc'/2</code></strong> allocates a C data area.  <code class="highlighter-rouge">'$c_malloc'(Size, Ptr)</code> is true if <code class="highlighter-rouge">Size</code> is a positive integer and <code class="highlighter-rouge">Ptr</code> (an integer) unifies with the address of the first byte of a data area allocated by the system call "malloc". The call fails if malloc returns a null pointer.</p>

<p><strong><code class="highlighter-rouge">'$c_free'/1</code></strong> frees a C data area.
<code class="highlighter-rouge">'$c_free'(Ptr)</code> is true if <code class="highlighter-rouge">Ptr</code> is a number, and it invokes the system call "free" to free the data area pointed by <code class="highlighter-rouge">Ptr</code>.</p>

<p>The next two predicates make use of the following encoding of C types:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      1  -- int
      2  -- unsigned int
      3  -- long
      4  -- unsigned long
      5  -- pointer
      6  -- char
      7  -- unsigned char
      8  -- short
      9  -- unsigned short
      10 -- string
      11 -- string of given length (length is 4th arg)
      12 -- float
      13 -- double
      14 -- far pointer  (DOS only)
      15 -- raw data of given length
</code></pre></div></div>

<p><strong><code class="highlighter-rouge">'$c_set'/2</code></strong> is used to modify the contents of a C data area or a UIA.</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'$c_set'(Ptr_or_UIA, FormatList)`
</code></pre></div></div>
<p>is true if <code class="highlighter-rouge">Ptr_or_UIA</code> is bound to the address of a C data area or a <code class="highlighter-rouge">UIA</code>, and <code class="highlighter-rouge">FormatList</code> is a non-empty list of 3-ary or 4-ary terms of the form</p>

<p><code class="highlighter-rouge">f(Offset, Type, Value {, Length })</code>    <em>(Length is used only with type code 11)</em></p>

<p>The complete call modifies the contents of the data area corresponding to each such term as follows:
<br />In each term, <code class="highlighter-rouge">Offset</code> is the offset of the field from the start address of the data area. <code class="highlighter-rouge">Type</code> is the C type code (as given above) of the field.  <code class="highlighter-rouge">Value</code> is the data that the field should be set to.  <code class="highlighter-rouge">Value</code> should be a prolog entity whose type corresponds naturally to the C entity type coded by <code class="highlighter-rouge">Type</code>.  Numeric C types require an appropriate prolog number. If <code class="highlighter-rouge">Type</code> is 10 or 11, then <code class="highlighter-rouge">Value</code> must be an atom (including possiblly a <code class="highlighter-rouge">UIA</code>), and a null terminated C string name of the atom is copied into the receiving data are without overflow checks. In the case of <code class="highlighter-rouge">Type</code>==11, at most <code class="highlighter-rouge">Length</code> bytes are copied into the receiving data area.</p>

<p><strong><code class="highlighter-rouge">'$c_examine'/2</code></strong> is used to examine the contents of a C data area or a <code class="highlighter-rouge">UIA</code>. 
<code class="highlighter-rouge">'$c_examine'(Ptr_or_UIA, FormatList)</code> is true if <code class="highlighter-rouge">Ptr_or_UIA</code> is bound to the address of a C data area or a <code class="highlighter-rouge">UIA</code>, and <code class="highlighter-rouge">FormatList</code> is a nonempty list of 3-ary or 4-ary terms of the form</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>f(Offset, Type, Value{, Length })
</code></pre></div></div>
<p>whose arguments are interpreted as in <code class="highlighter-rouge">'$c_set/2</code> (above) except that now a data item of the specified type is extracted from the data area and unified with <code class="highlighter-rouge">Value</code>.</p>

<h2 id="examples">EXAMPLES</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>?- Size = 1000, '$c_malloc'(Size, Ptr).

Size=1000 
Ptr=33558528 

yes.

?- '$c_malloc'(1000, Ptr), '$c_set'(Ptr,[f(0,12,14.5)]), '$c_examine'(Ptr,[g(0,12,X)]).

Ptr=41947136 
X=14.5 

yes.

?- UIA = 'Phantom', Value = w2g, '$c_set'(UIA, [f(3, 10, Value)]).

UIA='Phaw2g' 
Value=w2g 

yes.

?- UIA = 'Phantom', '$c_examine'(UIA, [f(2, 10, Value)]).

UIA='Phantom' 
Value=antom 

yes.

?- UIA = 'Phantom', '$c_examine'(UIA, [f(2, 11, Value, 3)]).

UIA='Phantom' 
Value=ant 

yes.
</code></pre></div></div>

<h2 id="notes">NOTES</h2>
<p>A slightly higher-level collection of C data access predicates is implemented over the predicates above in ~builtins/cutils.pro.  See <a href="calloc23.html">c_alloc/[2,3]</a> and <a href="ccreate3.html">c_create/3</a>.</p>
